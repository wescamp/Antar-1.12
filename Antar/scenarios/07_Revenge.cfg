#textdomain wesnoth-Antar

#define INITIALIZE_SCENARIO_VARIABLES
	{VARIABLE                fire_started no}
	{VARIABLE                  orc_burned  0}
	{VARIABLE                 wose_burned  0}
	{VARIABLE               troll_support no}
	{VARIABLE          troll_support_done no}
	{VARIABLE      troll_support_message  no}
	{VARIABLE  troll_support_message_done no}
	{VARIABLE                 wose_create  0}
	{VARIABLE          count_till_message  0}
	{VARIABLE                    attacker  0}
#enddef

#define CLEAR_SCENARIO_VARIABLES
	{CLEAR_VARIABLE                    new_fire}
	{CLEAR_VARIABLE            max_new_fire_hex}
	{CLEAR_VARIABLE             already_checked}    ### pillager firestart 1 to prevent the fire spreads to fast
	{CLEAR_VARIABLE                fire_started}    ### alternativ trigger for firespread
	{CLEAR_VARIABLE                    firedead}    ### fire_event firedead
	{CLEAR_VARIABLE                  orc_burned}    ### burned orc message 1 2 3
	{CLEAR_VARIABLE                 wose_burned}    ### burned wose message
	{CLEAR_VARIABLE               troll_support}    ### troll support what else
	{CLEAR_VARIABLE          troll_support_done}    ### troll support what else
	{CLEAR_VARIABLE       troll_support_message}    ### troll support what else
	{CLEAR_VARIABLE  troll_support_message_done}    ### troll support what else
	{CLEAR_VARIABLE                 wose_create}    ### count till wose appear
	{CLEAR_VARIABLE             wose_spot_found}    ### find a random hex from an array to place the first wose
	{CLEAR_VARIABLE            random_wose_spot}    ### find a random hex from an array to place the first wose
	{CLEAR_VARIABLE                 bagrokstore}    ### troll support
	{CLEAR_VARIABLE                    orc_gold}    ### end gold calculation
	{CLEAR_VARIABLE                  orc_gold_2}    ### end gold calculation
	{CLEAR_VARIABLE          count_till_message}    ### message wind fannded the fire...
	{CLEAR_VARIABLE                       ashes}    ### firespread random ashes terrain
	{CLEAR_VARIABLE                      random}
	{CLEAR_VARIABLE           terrain_to_change}    ### change fire 1 to fire 2 to fire 3 ...
	{CLEAR_VARIABLE            second_wose_goal}    ### set a goto for side 3 (woses)    
	{CLEAR_VARIABLE            second_wose_goal}    ### set a goto for side 3 (woses)
#enddef

#define EAST_HALF
	x=40-48
	y=1-26
#enddef

#define SAVE_SIDE_OF_THE_RIVER
	x=01-05,    06, 07-08, 09-10,    11,    12,    13, 14-15,    16,    17,    18,    19, 20-21,    22,    23, 24-26                                   #7-47,9-47,11-47,14-47,15-47,16-47,17-47,18-47,19-47,21-47,22-47,23-47,24-47,25-47,26-47
	y=01-26, 04-26, 05-26, 06-26, 07-26, 06-26, 07-26, 09-26, 10-26, 15-26, 16-26, 17-26, 19-26, 21-26, 24-26, 25-26,                                  #1-4 ,   5,    6,  7-8,    9,10-13,   14,15-16,17-18,   19,20-22,   23,   24,   25,   26
#enddef

#define FIRECHANGE FIRE1 TO_FIRE2
	[store_locations]
		variable=terrain_to_change
		terrain={FIRE1}
	[/store_locations]
	[if]
		[variable]
			name=terrain_to_change.length
			greater_than=0
		[/variable]
		[then]
			{FOREACH terrain_to_change current_hex}
				[terrain]
					x,y=$terrain_to_change[$current_hex].x,$terrain_to_change[$current_hex].y
					layer=overlay
					terrain={TO_FIRE2}
				[/terrain]
			{NEXT current_hex}
			{CLEAR_VARIABLE terrain_to_change}
		[/then]
	[/if]
#enddef

### X_2 Y_2 move firestarter to next spot
### A_1 A_1 start fire there

#define FIRESTART ID A_X1 A_Y1 X_2 Y_2
	[animate_unit]
		[filter]
			id={ID}
		[/filter]
		flag=attack
		hits=yes
		[primary_attack]
			name=torch
		[/primary_attack]
		[facing]
			[filter]
				x,y={A_X1},{A_Y1}
			[/filter]
		[/facing]
	[/animate_unit]
	[terrain]
		x,y={A_X1},{A_Y1}
		terrain=Gd^Fy0
		layer=overlay
	[/terrain]
	{ASoR_PHONO ambient/campfire.ogg}
	{ASoR_REDRAW}
	{MOVE_UNIT (id={ID}) {X_2} {Y_2}}
	{FIRESPREAD_1}
	[terrain]
		x,y={A_X1},{A_Y1}
		terrain=Gd^Fy1
		layer=overlay
	[/terrain]
#enddef

#define START_THE_FIRE
		[message]
			speaker=Hagtamorg
			message= _ "<b>NOW!</b>"
		[/message]

		#Pillager 1  Firestarter
		{ASoR_SCROLL_TO 42 26 300}
		[move_unit_fake]
			type=Goblin Pillager
			x=42,41,41
			y=26,26,25
			side=1
		[/move_unit_fake]
		[unit]
			type=Goblin Pillager
			[modifications]
				{TRAIT_QUICK}
			[/modifications]
			id="Kodarr"
			name="Ko`darr"
			side=2
			x,y=41,25
			facing=nw
		[/unit]
		[message]
			speaker="Kodarr"
			message= _ "Ready Chief, Har har!"
		[/message]
                              # fire   next stop
		{FIRESTART (Kodarr)    40 24    44 22}
		{FIRESTART (Kodarr)    45 23    45 19}
		{FIRESTART (Kodarr)    46 19    45 15}
		{FIRESTART (Kodarr)    46 15    45 11}
		{FIRESTART (Kodarr)    46 11    44  6}
		{FIRESTART (Kodarr)    45  7    42  3}
		{FIRESTART (Kodarr)    41  4    37  2}
		{FIRESTART (Kodarr)    36  2    32  1}
		{FIRESTART (Kodarr)    31  2    27  2}
		{FIRESTART (Kodarr)    26  2    22  1}
		{FIRESTART (Kodarr)    21  2    17  2}
		{FIRESTART (Kodarr)    16  2    (12,13)  (3,7)}

		{MODIFY_UNIT (id=Kodarr)    facing se}
		{ASoR_SCROLL_TO 13 7 200}
		[message]
			speaker="Kodarr"
			message= _ "Ha Ha Ha! Burn trees, burn Elves!
			
<b>Burn</b> Ha Ha Ha!"
		[/message]
		[unit]
			type=Orcish Grunt
			id="Kalldal"
			name="Kalldal"
			side=2
			x,y=10,12
			profile="portraits/orcs/transparent/grunt-3.png"
			ai_special=guardian
		[/unit]
		[message]
			speaker="Elorial Din"
			message= _ "<span size='xx-large' weight='heavy'>A trap! This is a trap! </span>"
			image="portraits/Elorial_Din.png~FL()~RIGHT()"
		[/message]
		[message]
			speaker="Kalldal"
			message= _ "Hey chief, the Elves are trapped like mice!"
		[/message]
		[message]
			speaker=Hagtamorg
			message= _ "Yes Mouse trapped! Hahaha!"
		[/message]

		[objectives]
			side=1
			[objective]
				condition=win
				description=_ "Survive and "
			[/objective]
			[objective]
				condition=win
				description=_ "Defeat the enemy leader"
			[/objective]
			[objective]
				condition=lose
				description=_ "Death of Elorial Din"
			[/objective]
			[objective]
				condition=lose
				description=_ "Turns run out"
				show_turn_counter=yes
			[/objective]

			note={EARLY_FINISH_BONUS_NOTE}+{NEW_GOLD_CARRYOVER_NOTE_40}
		[/objectives]
		# now the fire is started the orks should fall back, to be secure and not get burned
		[modify_side]
			side=2
			[ai]
				[avoid]
					x=25-48
				[/avoid]
			[/ai]
		[/modify_side]

		{VARIABLE_OP fire_started value yes}

		### update help menu
		{ASoR_TEMP_HELP ASoR_TH-7-02}
#enddef

#define KILL_BURNING_UNITS

		### check what side is burned

		### elvish fire victim

		[if]
			[variable]
				name=firedead.side
				equals=1
			[/variable]
			[then]
				[scroll_to]
					x=$firedead.x
					y=$firedead.y
				[/scroll_to]
				[message]
					speaker=$firedead.id
					message=_ "Ayyyyee"
				[/message]
				[kill]
					id=$firedead.id
					animate=yes
				[/kill]
				[if]
					[variable]
						name=firedead.id
						equals="Elorial Din"
					[/variable]
					[then]
						[message]
							race=elf
							message=_ "No, without Elorial Din we are lost!"
						[/message]
						{DEFEAT}
					[/then]
					[else]
						[message]
							speaker="Elorial Din"
							message=_ "No, $firedead.name is burned to death. Keep away from the fire!"
						[/message]
					[/else]
				[/if]
				{CLEAR_VARIABLE firedead}
			[/then]
		[/if]

		### orcish fire victim

		[if]
			[variable]
				name=firedead.side
				equals=2
			[/variable]
			[then]
				[scroll_to]
					x=$firedead.x
					y=$firedead.y
				[/scroll_to]
				{RANDOM        (Ayyyyyeee,Ahhrg,Ayyeee,Nooooo,I burn,Ayyyeee)}
				[message]
					speaker=$firedead.id
					message=_ "$random"
				[/message]
				[kill]
					id=$firedead.id
					animate=yes
				[/kill]
				{VARIABLE_OP orc_burned add 1}
				[if]
					[variable]
						name=orc_burned
						numerical_equals=1
					[/variable]
					[then]
						[message]
							speaker=Hagtamorg
							message= _ "*<i>Angry</i>*  Stay away from the fire useless fool!"
						[/message]
					[/then]
				[/if]
				[if]
					[variable]
						name=orc_burned
						numerical_equals=2
					[/variable]
					[then]
						[message]
							speaker=Hagtamorg
							message= _ "<b> I told you to stay away from the fire! </b> Why do they do not listen?"
						[/message]
					[/then]
				[/if]
				[if]
					[variable]
						name=orc_burned
						greater_than=2
					[/variable]
					[then]
						[message]
							speaker=Hagtamorg
							message= _ "They are so stupid, so stupid!"
						[/message]
					[/then]
				[/if]
				{CLEAR_VARIABLE random}
				{CLEAR_VARIABLE firedead}
			[/then]
		[/if]

		### wose fire victim

		[if]
			[variable]
				name=firedead.side
				equals=3
			[/variable]
			[then]
				[if]
					[variable]
						name=wose_burned
						numerical_equals=0
					[/variable]
					[then]
						[modify_side]
							side=3
							color=orange
							no_leader=yes
							user_team_name= _ "Wose"
							team_name=Antar
							canrecruit=no
							hidden=no
							gold=0
						[/modify_side]
						{ASoR_REDRAW}
						[modify_unit]
							[filter]
								id=$firedead.id
							[/filter]
							hitpoints=10
						[/modify_unit]
						[scroll_to]
							x=$firedead.x
							y=$firedead.y
						[/scroll_to]
						[message]
							speaker=$firedead.id
							message=_ "Ayyyyee"
						[/message]
#						[kill]
#							id=$firedead.id
#							animate=yes
#						[/kill]
						[harm_unit]
							[filter]
								id=$firedead.id
							[/filter]
							amount=10
							[secondary_attack]
								type=fire
							[/secondary_attack]
							kill=yes
							animate=yes
						[/harm_unit]
						{SCATTER_WOSE 1 (Ancient Wose)}
						[role]
							role=wose_speaker
							type=Ancient Wose
							side=3
						[/role]
						[scroll_to_unit]
							[filter]
								role=wose_speaker
							[/filter]
						[/scroll_to_unit]
						[message]
							role=wose_speaker
							message= _ "They burnt $firedead.name down! We can not longer be passive."
							image="portraits/wose_speaker.png~RIGHT()"
						[/message]
						{SCATTER_WOSE 1       (Wose)}
						{SCATTER_WOSE 1       (Wose)}
						{SCATTER_WOSE 1 (Elder Wose)}
						{SCATTER_WOSE 1       (Wose)}
						{SCATTER_WOSE 1       (Wose)}
						{SCATTER_WOSE 1 (Elder Wose)}
						{SCATTER_WOSE 1       (Wose)}
						{SCATTER_WOSE 1       (Wose)}
						{ASoR_REDRAW}
						[message]
							speaker="Elorial Din"
							message= _ "WOSES! They join us!"
						[/message]
						[if]
							[have_unit]
								id="Nopirmd"
							[/have_unit]
							[then]
								[message]
									speaker="Nopirmd"
									message= _ "I felt their presence since our arrival."
								[/message]
							[/then]
						[/if]
						{ASoR_DELAY 800}
						[message]
							role=wose_speaker
							message= _ "Lets smash those Orcs!"
						[/message]
						{VARIABLE_OP wose_burned add 1}
					[/then]
					[else]
						[modify_unit]
							[filter]
								id=$firedead.id
							[/filter]
							hitpoints=10
						[/modify_unit]
						[scroll_to]
							x=$firedead.x
							y=$firedead.y
						[/scroll_to]
						[message]
							speaker=$firedead.id
							message=_ "Ayyyyee"
						[/message]
#						[kill]
#							id=$firedead.id
#							animate=yes
#						[/kill]
						[harm_unit]
							[filter]
								id=$firedead.id
							[/filter]
							amount=10
							[secondary_attack]
								type=fire
							[/secondary_attack]
							kill=yes
							animate=yes
						[/harm_unit]
						[role]
							role=wose_speaker
							type=Ancient Wose,Elder Wose
							side=3
						[/role]
						[scroll_to_unit]
							[filter]
								role=wose_speaker
							[/filter]
						[/scroll_to_unit]
						{RANDOM         (They burnt $firedead.name down, $firedead.name goes down in flames, We lost our tree-brother $firedead.name, Oh no, $firedead.name, Oh no, $firedead.name is burnt to ashes)}
						[message]
							role=wose_speaker
							message= _ "$random!"
							image="portraits/woses/transparent/ancient-wose.png~RIGHT()"
						[/message]
						{CLEAR_VARIABLE random}
					[/else]
				[/if]
				{CLEAR_VARIABLE firedead}
			[/then]
		[/if]
#enddef


#define FIREPROGRESS
	[store_locations]
		variable=ashes
		terrain=*^Fy6
	[/store_locations]
	[if]
		[variable]
			name=ashes.length
			greater_than=0
		[/variable]
		[then]
			{FOREACH ashes current_hex}
				# this is to keep the hills after the fire is done
				# if the terrain is a hill, then use just a hill-overlay, else use a darker base terrain because it should look burned
				[if]
					[variable]
						name=ashes[$current_hex].terrain
						equals=Hh^Fy6
					[/variable]
					[or]
						[variable]
							name=ashes[$current_hex].terrain
							equals=Hhd^Fy6
						[/variable]
					[/or]
					[then]
						{RANDOM        (Hh^Fy7, Hh^Fy8, Hh^Fy9, Hh^Fy6, Hh^Fy6)}
						[terrain]
							x,y=$ashes[$current_hex].x,$ashes[$current_hex].y
							layer=overlay
							terrain=$random
						[/terrain]
						{CLEAR_VARIABLE RANDOM}
					[/then]
					[else]
						{RANDOM        (Rb^Fy7, Rb^Fy8, Rb^Fy9, Re^Fy7, Re^Fy8, Re^Fy9, Sm^Fy7, Sm^Fy8, Sm^Fy9, Hh^Fy6, Hh^Fy6)}
						[terrain]
							x,y=$ashes[$current_hex].x,$ashes[$current_hex].y
							terrain=$random
						[/terrain]
						{CLEAR_VARIABLE RANDOM}
					[/else]
				[/if]
			{NEXT current_hex}
			{CLEAR_VARIABLE ashes}
		[/then]
	[/if]

	# take care about possible overlooked hexes
	[store_locations]
		variable=new_fire
		terrain=Gs^Fms, Gs^Fp, Gs^Fdw, Gll^Fp, Gll^Fdw, Hh^Fmw, Hh^Fp, Hh^Fdw, Hhd^Fdw, Ce^Fp, Ke^Fp, Ce, Ss^Fdw, Ss^Fmw
		[filter_adjacent_location]
			terrain=*^Fy0, *^Fy1, *^Fy2, *^Fy3, *^Fy4, *^Fy5, *^Fy6
			count=5-6
		[/filter_adjacent_location]
	[/store_locations]
	[if]
		[variable]
			name=new_fire.length
			greater_than=0
		[/variable]
		[then]
			{FOREACH new_fire current_hex}
				[terrain]
					x,y=$new_fire[$current_hex].x,$new_fire[$current_hex].y
					layer=overlay
					terrain=Gd^Fy0
				[/terrain]
				[if]														### check if is a unit on the hex
					[have_unit]
						x=$new_fire[$current_hex].x
						y=$new_fire[$current_hex].y
					[/have_unit]
					[then]
						[store_unit]
							[filter]
								x=$new_fire[$current_hex].x
								y=$new_fire[$current_hex].y
							[/filter]
							variable=firedead
							kill=no
						[/store_unit]
						{ASoR_REDRAW}
						{KILL_BURNING_UNITS}
					[/then]
				[/if]
			 {NEXT current_hex}

			{CLEAR_VARIABLE new_fire}
		[/then]
	[/if]

	# change every fire terrain in the next fire terrain
	{FIRECHANGE (*^Fy5) (Gd^Fy6)}
	{FIRECHANGE (*^Fy4) (Gd^Fy5)}
	{FIRECHANGE (*^Fy3) (Gd^Fy4)}
	{FIRECHANGE (*^Fy2) (Gd^Fy3)}
	{FIRECHANGE (*^Fy1) (Gd^Fy2)}
	{FIRECHANGE (*^Fy0) (Gd^Fy1)}
#enddef


#define FIRESPREAD_1

	### transform random adjacent hexes to animated-fire-hexes
	# store all forest-hexes adjacent to fire-hexes
	[store_locations]
		variable=new_fire
		terrain=Gs^Fms, Gs^Fp, Gs^Fdw, Gll^Fp, Hh^Fmw, Hh^Fp, Hh^Fdw, Ce
		[filter_adjacent_location]
			terrain=*^Fy0
		[/filter_adjacent_location]
		[not]
			find_in=already_checked
		[/not]
	[/store_locations]
	# set random number of adjacent-to-fire hexes on fire
	{FOREACH new_fire current_hex}
		{VARIABLE max_new_fire_hex 0}
		{RANDOM        0,1,1,2,3,3,4}
		[while]
			[variable]
				name=max_new_fire_hex
				less_than=$random
			[/variable]
			[do]
				[terrain]
					x=$new_fire[$current_hex].x
					y=$new_fire[$current_hex].y
					layer=overlay
					terrain=Gd^Fy0
				[/terrain]
				{ASoR_PHONO ambient/campfire.ogg}
				{VARIABLE_OP max_new_fire_hex add 1}
				[if]														### check if is a unit on the hex
					[have_unit]
						x=$new_fire[$current_hex].x
						y=$new_fire[$current_hex].y
					[/have_unit]
					[then]
						[store_unit]
							[filter]
								x=$new_fire[$current_hex].x
								y=$new_fire[$current_hex].y
							[/filter]
							variable=firedead
							kill=no
						[/store_unit]
						{ASoR_REDRAW}
						{KILL_BURNING_UNITS}
					[/then]
				[/if]
			[/do]
		[/while]
		[store_locations]
			variable=already_checked
			terrain=Gs^Fms,Gs^Fp,Gs^Fdw,Gll^Fp,Hh^Fmw,Hh^Fp,Hh^Fdw,Ce
			[filter_adjacent_location]
				terrain=*^Fy0
			[/filter_adjacent_location]
		[/store_locations]
		{CLEAR_VARIABLE max_new_fire_hex}
		{CLEAR_VARIABLE RANDOM}
		{NEXT current_hex}
#enddef

#define FIRESPREAD_2

	### transform random adjacent forest-hexes to animated-fire-hexes
	# one step progress for each fire terrain
	{FIREPROGRESS}
	# store all forest-hexes adjacent to fire-hexes
	[store_locations]
		variable=new_fire
		terrain=Gs^Fms, Gs^Fp, Gs^Fdw, Gll^Fp, Gll^Fdw, Hh^Fmw, Hh^Fp, Hh^Fdw, Hhd^Fdw, Ce^Fp, Ke^Fp, Ce, Ss^Fdw, Ss^Fmw
		[filter_adjacent_location]
			terrain=*^Fy1, *^Fy2, *^Fy3, *^Fy4, *^Fy5
		[/filter_adjacent_location]
	[/store_locations]

	# set random hex to create the initial wose
	{VARIABLE_OP wose_create add 1}
	[if]
		[variable]
			name=wose_create
			numerical_equals=4
		[/variable]
		[then]
			[set_variable]
				name=random_wose_spot
#				rand=4..$new_fire.length
#				rand=4..8
				rand=8..16
			[/set_variable]
			{VARIABLE wose_spot_found 0}
		[/then]
	[/if]
	# set random number of adjacent-to-fire hexes on fire
	{FOREACH new_fire current_hex}
		{VARIABLE max_new_fire_hex 0}
#ifdef EASY
		{RANDOM        0,0,0,1,1,1,2}
#endif
#ifdef NORMAL
		{RANDOM        0,0,1,1,1,1,2}
#endif
#ifdef HARD
		{RANDOM        0,0,1,1,1,2,2}
#endif
		[while]
			[variable]
				name=max_new_fire_hex
				less_than=$random
			[/variable]
			[do]
				[if]
					[variable]
						name=wose_create
						greater_than=3
					[/variable]
					[then]
						{VARIABLE_OP wose_spot_found add 1}
						[if]
							[variable]
								name=wose_spot_found
								equals=$random_wose_spot
							[/variable]
							[then]
								[if]
									[have_unit]
										side=3
										count=0
									[/have_unit]
									[then]
										{ASoR_GENERIC_GUARD_UNIT 3 (Ancient Wose) $new_fire[$current_hex].x $new_fire[$current_hex].y}
										[+unit]
											attacks_left=0
											moves=0
											goto_x=25
											goto_y=17
										[/unit]
										{CLEAR_VARIABLE random_wose_spot}
									[/then]
								[/if]
							[/then]
						[/if]
					[/then]
				[/if]
				[terrain]
					x=$new_fire[$current_hex].x
					y=$new_fire[$current_hex].y
					layer=overlay
					terrain=Gd^Fy0
				[/terrain]
				{ASoR_PHONO ambient/campfire.ogg}
				{VARIABLE_OP max_new_fire_hex add 1}
				[if]														### check if is a unit on the hex
					[have_unit]
						x=$new_fire[$current_hex].x
						y=$new_fire[$current_hex].y
					[/have_unit]
					[then]
						[store_unit]
							[filter]
								x=$new_fire[$current_hex].x
								y=$new_fire[$current_hex].y
							[/filter]
							variable=firedead
							kill=no
						[/store_unit]
						{ASoR_REDRAW}
						{KILL_BURNING_UNITS}
					[/then]
				[/if]
			[/do]
		[/while]
		{CLEAR_VARIABLE max_new_fire_hex}
		{CLEAR_VARIABLE RANDOM}
	{NEXT current_hex}
	{VARIABLE_OP count_till_message add 1}
#enddef


	#the idea and code for this is taken from Grnk the mighty by mattsc
#define MODIFY_TRAPDOOR PERCENTAGE X Y
	{MODIFY_TERRAIN Ko^Td{PERCENTAGE} {X} {Y}}
	{ASoR_REDRAW}
#enddef










[scenario]
	id="Revenge"
	name= _ "Revenge"
	map_data="{~add-ons/Antar/maps/07_Revenge.map}"
	{TURNS 28 24 22}
	victory_when_enemies_defeated=yes

	{DEFAULT_SCHEDULE}

#	next_scenario="The_Dwarves"
	next_scenario="Cutscene_Flight"

	{MOOD_MAINTHEME}

	[side]
		{ELORIAL_DIN_SIDE}
		side=1
		recruit= Elvish Archer, Elvish Fighter, Elvish Scout, Elvish Shaman
		team_name=Antar
		fog=no
		shroud=no
		gold=250
	[/side]


	[side]
		type=Orcish Sovereign
		id=Hagtamorg
		name= _ "Hag`ta`morg"
		profile="portraits/orcs/sovereign.png"
		side=2
		color=brown
		team_name=Orcs
		user_team_name= _ "Enemy"
		canrecruit=yes
		recruit=Goblin Spearman #, Goblin Impaler
		[ai]
			aggression=1.0
			caution=0.0
			grouping=no
			passive_leader=yes
			{ASoR_AI_GOAL__TARGET_SIDE__SIDES_VALUE (1) 5}
			{ASoR_AI_GOAL__TARGET_SIDE__SIDES_VALUE (3) 1}
			{ASoR_AI_GOAL__PROTECT_LOCATION__X_Y_RADIUS_VALUE 23 25 10 5}
			{ASoR_AI_GOAL__PROTECT_UNIT__ID_RADIUS_VALUE Hagtamorg 10 5}
		[/ai]
		{GOLD 230 250 270}
		{INCOME 12 17 22}
		{FLAG_VARIANT ragged}
	[/side]

	{STARTING_VILLAGES 2 25}

	[side]
		side=3
		color=orange
		no_leader=yes
		user_team_name= _ "Ally"
		team_name=Wose
		canrecruit=no
		[ai]
#			{ASoR_AI_GOAL__TARGET_ID_VALUE Hagtamorg 5}            ###this seems to override the goto_x,goto_y 
			villages_per_scout=0
			village_value=0
		[/ai]
#ifver WESNOTH_VERSION <= 1.11.6
	#	{MICRO_AI_MESSENGER_ESCORT}
#endif
		hidden=yes
		gold=0
	[/side]


#	{ASoR_LIMIT_CONTEMPORANEOUS_RECRUITS_DIFFICULTY_DEPENDANT (2)          "Orcish Warrior"       1 2 3}
#	{ASoR_LIMIT_CONTEMPORANEOUS_RECRUITS_DIFFICULTY_DEPENDANT (2)          "Orcish Crossbowman"   1 1 2}
#	{ASoR_LIMIT_CONTEMPORANEOUS_RECRUITS_DIFFICULTY_DEPENDANT (2)          "Orcish Assassin"      2 3 3}
#	{ASoR_LIMIT_CONTEMPORANEOUS_RECRUITS_DIFFICULTY_DEPENDANT (2)          "Orcish Grunt"         5 6 7}
#	{ASoR_LIMIT_CONTEMPORANEOUS_RECRUITS_DIFFICULTY_DEPENDANT (2)          "Orcish Archer"        3 4 5}
#	{ASoR_LIMIT_CONTEMPORANEOUS_RECRUITS_DIFFICULTY_DEPENDANT (2)          "Wolf Rider"           1 1 1}
#	{ASoR_LIMIT_CONTEMPORANEOUS_RECRUITS_DIFFICULTY_DEPENDANT (2)          "Goblin Impaler"       2 2 2}

	{CIRCULAR_RECRUIT 2 (Wolf Rider; Orcish Grunt; Goblin Impaler; Orcish Crossbowman; Orcish Archer; Orcish Warrior; Orcish Grunt; Goblin Rouser; Goblin Axeman; Orcish Archer; Orcish Grunt; Orcish Assassin)}








	{STORY_REVENGE}










	[event]
		name=prestart

		{ASoR_GENERIC_NAMED_GUARD_UNIT 2 "Orcish Crossbowman"   18  9 (Lugro)   }
		{ASoR_GENERIC_NAMED_GUARD_UNIT 2 "Orcish Slurbow"       18 12 (Blorsmer)}
		{GENERIC_UNIT 2 "Orcish Warrior"     21 21} {GUARDIAN}
		{GENERIC_UNIT 2 "Orcish Crossbowman" 17 17} {GUARDIAN}
		{GENERIC_UNIT 2 "Orcish Grunt"       15 12} {GUARDIAN}
		{GENERIC_UNIT 2 "Orcish Grunt"       24 25} {GUARDIAN}
		{GENERIC_UNIT 2 "Orcish Archer"      23 25} {GUARDIAN}
#ifdef HARD
		{GENERIC_UNIT 2 "Orcish Archer"      24 26} {GUARDIAN}
#endif

		{CHECK_ELORIALS_LOYALS 1}


		{PLACE_IMAGE scenery/trapdoor-closed.png 13 11}

		{MODIFY_UNIT (id="Elorial Din")  facing sw}
		{MODIFY_UNIT (id=Bridal)         facing sw}
		{MODIFY_UNIT (id=Emirond)        facing sw}
		{MODIFY_UNIT (id=Nopirmd)        facing sw}

		[objectives]
			side=1
			[objective]
				condition=win
				description=_ "Defeat the enemy leader"
			[/objective]
			[objective]
				condition=lose
				description=_ "Death of Elorial Din"
			[/objective]
			[objective]
				condition=lose
				description=_ "Turns run out"
				show_turn_counter=yes
			[/objective]

			note={EARLY_FINISH_BONUS_NOTE}+{NEW_GOLD_CARRYOVER_NOTE_40}
		[/objectives]


		{THE_USUAL_ASoR_MACROS}

		{INITIALIZE_SCENARIO_VARIABLES}

		{ASoR_TEMP_HELP ASoR_TH-7-01}
	[/event]










		###################
		###### start ######
		###################

	[event]
		name=start
		{ASoR_DELAY 500}
		[message]
			speaker="Elorial Din"
			message= _ "There they are..."
			image="portraits/Elorial_Din.png~FL()~RIGHT()"
		[/message]
		{ASoR_SCROLL_TO 13 11 1000}
		[message]
			speaker="Elorial Din"
			message= _ "Let’s bring the war back to the Orcs."
			image="portraits/Elorial_Din.png~FL()~RIGHT()"
		[/message]
	[/event]


	[event]
		name=side 1 turn 1 end
		first_time_only=yes
		[message]
			speaker=Hagtamorg
			message= _ "The Elves attack!"
		[/message]
		[message]
			speaker=Hagtamorg
			message= _ "Wake up you lazy dog's, defend my fortress. Kill the damn Elves!"
		[/message]
		[message]
			race=elf
			[not]
				id="Elorial Din"
			[/not]
			message= _ "They have discovered us."
		[/message]
		[message]
			speaker="Elorial Din"
			message= _ "Change of plan, <b>ATTACK!</b>"
		[/message]
	[/event]


		#########################
		### firestarter event ###
		#########################

	[event]
		name=turn end
		first_time_only=no
		[if]
			[variable]
				name=fire_started
				equals=no
			[/variable]
			[then]
				[if]
					[have_unit]
						side=1
						{EAST_HALF}
					[/have_unit]
					[then]
						# do nothing
					[/then]
					[else]
						{START_THE_FIRE}
					[/else]
				[/if]
			[/then]
		[/if]
	[/event]

	### alternate fire start when it is on turn 6 not yet triggered

	[event]
		name=turn 6 end
		[if]
			[variable]
				name=fire_started
				equals=no
			[/variable]
			[then]
				{START_THE_FIRE}
			[/then]
		[/if]
	[/event]


		###################
		### fire spread ###
		###################

	[event]
		name=turn end
		first_time_only=no
		[filter_condition]
			[variable]
				name=fire_started
				equals=yes
			[/variable]
		[/filter_condition]
		{FIRESPREAD_2}
	[/event]

	[event]
		name=new turn
		first_time_only=no
		[filter_condition]
			[variable]
				name=count_till_message
				numerical_equals=2
			[/variable]
		[/filter_condition]
		[message]
			speaker=narrator
			message=_ "Wind fanned the fire into a brisk blaze."
			image=wesnoth-icon.png
			{ASoR_PHONO ambient/campfire.ogg}
		[/message]
		{FIRESPREAD_2}
		[message]
			speaker="Elorial Din"
			message= _ "The fire is everywhere."
		[/message]
		{ASoR_SCROLL_TO 20  3 500}
		{ASoR_SCROLL_TO 43  6 500}
		{ASoR_SCROLL_TO 44 22 500}
		[message]
			speaker="Elorial Din"
			message= _ "We must reach the other side of the river. Otherwise we are doomed to be scorched here."
		[/message]
		{ASoR_SCROLL_TO 13 22 500}
		[scroll_to_unit]
			id="Elorial Din"
		[/scroll_to_unit]
	[/event]


		#################################################################
		### change woses goal, and again when they are over the river ###
		#################################################################

	[event]
		name=side 3 turn refresh
		first_time_only=no
		[store_unit]
			[filter]
				side=3
				[not]
					[filter_location]
						{SAVE_SIDE_OF_THE_RIVER}
						[filter]
							side=3
						[/filter]
					[/filter_location]
				[/not]
			[/filter]
			variable=first_wose_goal
			kill=no
		[/store_unit]
		{FOREACH first_wose_goal i}
			[set_variable]
				name=first_wose_goal[$i].goto_x
				value=11
			[/set_variable]
			[set_variable]
				name=first_wose_goal[$i].goto_y
				value=21
			[/set_variable]
			[unstore_unit]
				variable=first_wose_goal[$i]
			[/unstore_unit]
		{NEXT i}
		{CLEAR_VARIABLE first_wose_goal}


		[store_unit]
			[filter]
				side=3
				[filter_location]
					{SAVE_SIDE_OF_THE_RIVER}
					[filter]
						side=3
					[/filter]
				[/filter_location]
			[/filter]
			variable=second_wose_goal
			kill=no
		[/store_unit]
		{FOREACH second_wose_goal i}
			[set_variable]
				name=second_wose_goal[$i].goto_x
				value=""
			[/set_variable]
			[set_variable]
				name=second_wose_goal[$i].goto_y
				value=""
			[/set_variable]
			[unstore_unit]
				variable=second_wose_goal[$i]
			[/unstore_unit]
		{NEXT i}
		{CLEAR_VARIABLE second_wose_goal}
	[/event]



		############################################################
		### message elves are save on the west side of the river ###
		############################################################

	[event]
		name=moveto 
		[filter_condition]
			[not]
				[have_unit]
					side=1,3
					[not]
						{SAVE_SIDE_OF_THE_RIVER}
					[/not]
				[/have_unit]
			[/not]
		[/filter_condition]
		[message]
			speaker="Elorial Din"
			message= _ "All of us are on the other side of the river!"
		[/message]
		[message]
			speaker="Elorial Din"
			message= _ "Now to you, Orc."
		[/message]
	[/event]


		###########################################
		### message elves invade the orc castle ###
		###########################################

	[event]
		name=moveto
		first_time_only=yes

		[filter]
			side=1
			[filter_location]
				x=09,    10, 11,    12, 12,    12,    13, 13,    14, 14, 14,    15, 15                            #10-11,10,  12,  13,13,  14,14,   15
				y=11, 11-12, 12, 06-07, 09, 11-12, 09-12, 16, 10-12, 14, 16, 10-13, 15                            #   11,12,9-11,9-11,16,9-13,16,10-13
			[/filter_location]
		[/filter]
		[if]
			[have_unit]
				side=2
				[not]
					canrecruit=yes
				[/not]
			[/have_unit]
			[then]
				[message]
					speaker=Hagtamorg
					message= _ "They invade the stronghold!

Kill them finally!"
				[/message]
				[message]
					speaker="Elorial Din"
					message= _ "You are the one who will die!"
				[/message]
			[/then]
			[else]
				[message]
					speaker=Hagtamorg
					message= _ "They invade my stronghold!"
				[/message]
			[/else]
		[/if]
		[modify_side]
			side=2
			income=0
		[/modify_side]
	[/event]


		#####################
		### troll support ###
		#####################

	[event]
		name=turn 8

		[event]
			name=die
			first_time_only=no
			[filter]
				side=2
			[/filter]
			[if]
				[have_unit]
					side=2
					count=1-19
				[/have_unit]
				[then]
					{VARIABLE_OP troll_support_message value yes}
					[if]
						[variable]
							name=troll_support_message_done
							equals=no
						[/variable]
						[then]
							[message]
								speaker=Hagtamorg
								message= _ "What became of the damn Orc I sent for reinforcements?"
							[/message]
							[message]
								speaker="Kalldal"
								message= _ "He should already be back!"
							[/message]
							[message]
								speaker=Hagtamorg
								message= _ "He better hurry, or..."
							[/message]
							{VARIABLE_OP troll_support_message_done value yes}
						[/then]
					[/if]
				[/then]
			[/if]
			[if]
				[have_unit]
					side=2
					count=1-14
				[/have_unit]
				[then]
					{VARIABLE_OP troll_support value yes}
					{VARIABLE_OP troll_support_message value yes}
				[/then]
			[/if]
		[/event]
	[/event]

	[event]
		name=side 2 turn
		first_time_only=no
		[if]
			[variable]
				name=troll_support
				equals=yes
			[/variable]
			[variable]
				name=troll_support_done
				equals=no
			[/variable]
			[then]
				{NAMED_UNIT 2 "Orcish Leader" 1  4     "Bagrok" "Bagrok" ()}
				{MOVE_UNIT id=Bagrok  4 6}
				{ASoR_GENERIC_GUARD_UNIT_WITH_ID 2 (Troll)       Troll1 1 4}
				[+unit]
					facing=se
				[/unit]
				{MOVE_UNIT id=Troll1  4 5}
				{ASoR_GENERIC_GUARD_UNIT_WITH_ID 2 (Troll Whelp) Troll2 1 4}
				[+unit]
					facing=se
				[/unit]
				{MOVE_UNIT id=Troll2  3 4}
				{ASoR_GENERIC_GUARD_UNIT_WITH_ID 2 (Troll Whelp) Troll3 1 4}
				[+unit]
					facing=se
				[/unit]
				{MOVE_UNIT id=Troll3  3 5}
				{ASoR_GENERIC_GUARD_UNIT_WITH_ID 2 (Troll Whelp) Troll4 1 4}
				[+unit]
					facing=se
				[/unit]
				{MOVE_UNIT id=Troll4 2 5}
#ifdef NORMAL
				{ASoR_GENERIC_GUARD_UNIT_WITH_ID 2 (Troll)       Troll5 1 4}
#endif
#ifdef HARD
				{ASoR_GENERIC_GUARD_UNIT_WITH_ID 2 (Troll Whelp) Troll6 1 3}
#endif
				[message]
					speaker="Bagrok"
					message= _ "Hey chief! I bring some Trolls for reinforcement."
				[/message]
				[message]
					speaker=Hagtamorg
					message= _ "Ah, Trolls, very good."
				[/message]
				[modify_unit]
					[filter]
						id=Bagrok
					[/filter]
					side=2
					max_moves=5
					zoc=yes
				[/modify_unit]
				{VARIABLE_OP troll_support_done value yes}
			[/then]
		[/if]
	[/event]


	[event]
		name=side 2 turn
		first_time_only=no
		{MODIFY_UNIT (id=Troll1) moves 0}
		{MODIFY_UNIT (id=Troll2) moves 0}
		{MODIFY_UNIT (id=Troll3) moves 0}
		{MODIFY_UNIT (id=Troll4) moves 0}
#ifdef NORMAL
		{MODIFY_UNIT (id=Troll5) moves 0}
#endif
#ifdef HARD
		{MODIFY_UNIT (id=Troll6) moves 0}
#endif
	[/event]

	[event]
		name=moveto
		first_time_only=no
		x,y=1-48,1-26
		[filter]
			id="Bagrok"
		[/filter]
		[store_unit]
			[filter]
				id="Bagrok"
			[/filter]
			mode=replace
			variable=bagrokstore
		[/store_unit]
		{MOVE_UNIT (id=Troll1)  $bagrokstore.x, $bagrokstore.y}
		{MODIFY_UNIT (id=Troll1) moves 1}
		{MOVE_UNIT (id=Troll2)  $bagrokstore.x, $bagrokstore.y}
		{MODIFY_UNIT (id=Troll2) moves 2}
		{MOVE_UNIT (id=Troll3)  $bagrokstore.x, $bagrokstore.y}
		{MODIFY_UNIT (id=Troll3) moves 3}
		{MOVE_UNIT (id=Troll4)  $bagrokstore.x, $bagrokstore.y}
		{MODIFY_UNIT (id=Troll4) moves 3}
#ifdef NORMAL
		{MOVE_UNIT (id=Troll5)  $bagrokstore.x, $bagrokstore.y}
		{MODIFY_UNIT (id=Troll5) moves 3}
#endif
#ifdef HARD
		{MOVE_UNIT (id=Troll6)  $bagrokstore.x, $bagrokstore.y}
		{MODIFY_UNIT (id=Troll6) moves 3}
#endif
	[/event]


		#####################################################################
		### don't let the both orcs be guardian on the burning river side ###
		#####################################################################

	[event]
		name=turn 9
		{CLEAR_GUARDIAN (Lugro)}
	[/event]

	[event]
		name=turn 12
		{CLEAR_GUARDIAN (Blorsmer)}
	[/event]


		###############################
		### Hagtamorg gets attacked ###
		###############################

	[event]
		name=attack_end
		first_time_only=no
		[filter_second]
			id=Hagtamorg
		[/filter_second]
		[store_unit]
			[filter]
				id=Hagtamorg
			[/filter]
			variable=stored_hagtamorg
			kill=no
		[/store_unit]
		[unstore_unit]
			variable=stored_hagtamorg
			fire_event=yes
		[/unstore_unit]
		[if]
			[variable]
				name=stored_hagtamorg.hitpoints
				greater_than=30
			[/variable]
			[then]
				[if]
					[variable]
						name=unit.race
						equals=elf
					[/variable]
					[then]
						[message]
							speaker=Hagtamorg
							message= _ "Damn Elves!"
						[/message]
					[/then]
					[else]
						[message]
							speaker=Hagtamorg
							message= _ "Damn trees!"
						[/message]
					[/else]
				[/if]
			[/then]
			[else]
				[message]
					speaker=Hagtamorg
					message= _ "No, you don't get me.

Mal Kazur has promised so much to me. I will rule..."
				[/message]
				[if]
					[have_unit]
						id=$unit.id
					[/have_unit]
					[then]
						[modify_unit]
							[filter]
								id=$unit.id
							[/filter]
							role=elf_fighter
						[/modify_unit]
					[/then]
					[else]
						[role]
							role=elf_fighter
							type=Elvish Fighter,Elvish Hero,Elvish Shaman,Elvish Sylph,Elvish Enchantress,Elvish Sorceress
							side=1
						[/role]
					[/else]
				[/if]

				[animate_unit]
					[filter]
						id=Hagtamorg
					[/filter]
					flag=attack
					hits=no
					with_bars=no
					[primary_attack]
						name=greatsword
					[/primary_attack]
					[facing]
						[filter]
							x,y=11,2
						[/filter]
					[/facing]
				[/animate_unit]
				[animate_unit]
					[filter]
						id=Hagtamorg
					[/filter]
					flag=attack
					hits=no
					with_bars=no
					[primary_attack]
						name=greatsword
					[/primary_attack]
					[facing]
						[filter]
							x,y=13,2
						[/filter]
					[/facing]
				[/animate_unit]
				[store_unit]
					[filter]
						[filter_adjacent]
							id=Hagtamorg
						[/filter_adjacent]
						[not]
							side=2
						[/not]
					[/filter]
					variable=tossed_units
					kill=yes
				[/store_unit]
				### toss all surounding enemies away
				{FOREACH tossed_units i}
					{VARIABLE move_x $tossed_units[$i].x}
					{VARIABLE move_y $tossed_units[$i].y}
					{VARIABLE_OP move_x sub $stored_hagtamorg.x}
					{VARIABLE_OP move_y sub $stored_hagtamorg.y}
					{VARIABLE_OP tossed_units[$i].x add $move_x}
					{VARIABLE_OP tossed_units[$i].y add $move_y}
					[unstore_unit]
						variable=tossed_units[$i]
						find_vacant=yes
						check_passability=yes
					[/unstore_unit]
				{NEXT i}
				{CLEAR_VARIABLE tossed_units}
				{CLEAR_VARIABLE move_x}
				{CLEAR_VARIABLE move_y}
				{ASoR_REDRAW}
				[message]
					speaker=narrator
					message=_ "With a mighty strike the Ork leader pushed the Elves back."
					image=wesnoth-icon.png
				[/message]
				{ASoR_PHONO (open-chest.wav)}
				{REMOVE_IMAGE 13 11}
				{PLACE_IMAGE scenery/trapdoor-open.png 13 11}
				[message]
					speaker=Hagtamorg
					message= _ "I leave now, but we meet again, HarHarHar."
				[/message]
				{MODIFY_TRAPDOOR 10 $stored_hagtamorg.x $stored_hagtamorg.y}
				{MODIFY_TRAPDOOR 40 $stored_hagtamorg.x $stored_hagtamorg.y}
				{MODIFY_TRAPDOOR 70 $stored_hagtamorg.x $stored_hagtamorg.y}
				{MODIFY_TRAPDOOR T  $stored_hagtamorg.x $stored_hagtamorg.y}
				[kill]
					id=Hagtamorg
					animate=no
				[/kill]
#				{CLEAR_VARIABLE stored_hagtamorg}     ### => don't clear -> needed for next scenarios set hitpoints
			[/else]
		[/if]

	[/event]

	[event]
		name=enemies defeated

		[message]
			role=elf_fighter
			message= _ "A trapdoor ... he escapes!"
		[/message]

	### if some orcs are still alive, then they flee

		[if]
			[have_unit]
				side=2
			[/have_unit]
			[then]
				[kill]
					side=2
					animate=no
				[/kill]
				[message]
					speaker="Elorial Din"
					message= _ "The surviving Orcs have fled to the hills."
				[/message]
			[/then]
			[else]
				[message]
					speaker="Elorial Din"
					message= _ "Every Orc here has been slain, we have left none alive."
				[/message]
			[/else]
		[/if]

		###some gold for the surviving elves

		[store_gold]
			side=1
			variable=orc_gold                      ### is expected negativ elf-gold
		[/store_gold]
		[if]
			[variable]
				name=orc_gold
				less_than=0
			[/variable]
			[then]
				[store_gold]
					side=1
					variable=orc_gold_2             ### is expected negativ elf-gold
				[/store_gold]
				{VARIABLE_OP orc_gold sub $orc_gold}
				{VARIABLE_OP orc_gold sub $orc_gold_2}
				{VARIABLE_OP orc_gold add 100}
				{VARIABLE_OP orc_gold round -2}
			[/then]
			[else]
				[if]
					[variable]
						name=orc_gold
						greater_than=-1
					[/variable]
					[variable]
						name=orc_gold
						less_than=100
					[/variable]
					[then]
						{VARIABLE orc_gold 120}
					[/then]
					[else]
						[if]
							[variable]
								name=orc_gold
								greater_than=49
							[/variable]
							[then]
								{VARIABLE orc_gold 70}
							[/then]
							[else]
								{VARIABLE orc_gold 20}
							[/else]
						[/if]
					[/else]
				[/if]
				{VARIABLE orc_gold 50}
			[/else]
		[/if]

		[message]
			role=elf_fighter
			message= _ "This Orc has $orc_gold pieces of gold."
		[/message]
		[gold]
			side=1
			amount=$orc_gold
		[/gold]
		{ASoR_PHONO gold.ogg}
		[message]
			race=elf
			[not]
				canrecruit=yes
			[/not]
			message= _ "Hag`ta`morg is defeated and on the run, this will be a lesson for the Orcs."
		[/message]
		[message]
			speaker="Elorial Din"
			message= _ "No, we're not done yet! We follow him! He is not allowed to escape. He have to pay for his deeds."
		[/message]
		[message]
			race=elf
			[not]
				canrecruit=yes
			[/not]
			message= _ "Underground?"
		[/message]
		[message]
			speaker="Elorial Din"
			message= _ "Yes."
		[/message]
		[message]
			speaker="Elorial Din"
			message= _ "Mal Kazur, that name again."
		[/message]
		[if]
			[have_unit]
				side=3
			[/have_unit]
			[then]
				[role]
					role=wose_survivor
					type=Ancient Wose,Elder Wose,Wose
					side=3
				[/role]
				[scroll_to_unit]
					[filter]
						role=wose_survivor
					[/filter]
				[/scroll_to_unit]
				{ASoR_DELAY 400}
				[if]
					[have_unit]
						side=3
						count=1
					[/have_unit]
					[then]
						[message]
							role=wose_survivor
							message= _ "My habitat is burnt to ashes, I have decided to join you. I will take revenge on the ones who bear the blame for this."
						[/message]
					[/then]
					[else]
						[message]
							role=wose_survivor
							message= _ "Our habitat is burnt to ashes, We have decided to join you. We will take revenge on the ones who bear the blame for this."
						[/message]
					[/else]
				[/if]
				[message]
					speaker="Elorial Din"
					message= _ "Fight with us against Mal Kazur, or we all lose our homes, our freedom and our lives."
				[/message]
				{MODIFY_UNIT (side=3) side 1}
#				[modify_unit]
#					[filter]
#						role=wose_survivor
#					[/filter]
#					{TRAIT_LOYAL}
#					overlays=misc/hero-icon.png
#				[/modify_unit]
				[modify_unit]
					[filter]
						role=wose_survivor
					[/filter]
					[modifications]
						[trait]
							id=loyal
							male_name= _ "loyal"
							female_name= _ "female^loyal"
							description= _ "Zero upkeep"
							[effect]
								apply_to=loyal
							[/effect]
						[/trait]
					[/modifications]
					overlays="misc/loyal-icon.png"
				[/modify_unit]
#				[allow_recruit]
#					type=Wose
#					side=1
#				[/allow_recruit]
#				[message]
#					speaker=narrator
#					message= _ "Elorial Din may now recruit Wose."
#					image=wesnoth-icon.png
#				[/message]
#				[print]
#					text= _ "You can now recruit Wose!"
#					duration=80
#					size=22
#					red,green,blue=255,255,255
#				[/print]
			[/then]
			[else]
				[message]
					speaker="Elorial Din"
					message= _ "It is sad that no Wose survived. Maybe they would have fought with us against Mal Kazur. Sad, they were strong creatures and die-hard fighters."
				[/message]
			[/else]
		[/if]

		[message]
			speaker="Elorial Din"
			message=_ "So now let’s go underground. We have to find and defeat Hag`ta`morg."
		[/message]
		[endlevel]
			result=victory
			bonus=yes
			{NEW_GOLD_CARRYOVER 40}
		[/endlevel]
	[/event]

	[event]
		name=victory
		{CLEAR_SCENARIO_VARIABLES}
	[/event]

	{~add-ons/Antar/utils/utils.cfg}
	{~add-ons/Antar/utils/deaths.cfg}
[/scenario]


#undef START_THE_FIRE
#undef KILL_BURNING_UNITS
#undef SCATTER_WOSE NUMBER TYPE
#undef FIRESTART ID A_X1 A_Y1 X_2 Y_2
#undef FIRESPREAD_1
#undef FIRESPREAD_2
#undef SAVE_SIDE_OF_THE_RIVER
#undef EAST_HALF
#undef FIRECHANGE FIRE1 TO_FIRE2
#undef INITIALIZE_SCENARIO_VARIABLES
#undef CLEAR_SCENARIO_VARIABLES
